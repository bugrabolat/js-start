<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css"
    integrity="sha512-KfkfwYDsLkIlwQp6LFnl8zNdLGxu9YAA1QvwINks4PhcElQSvqcyVLLD9aMhXd13uQjoXtEKNosOWaZqXgel0g=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor" crossorigin="anonymous" />

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-pprn3073KE6tl6bjs2QrFaJGz5/SUsLqktiwsUTF55Jfv3qYSDhgCecCxMW52nD2"
    crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"
    integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="index.css" />
  <link rel="stylesheet" href="urun-detay.css">
  <title>Document</title>
</head>

<body>
  <div class="nav-bar">
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
      <div class="container-fluid">
        <img src="img/bayaz-logo.png" style="width: 100px; margin-right: 250px;" height="20px" alt="" />
        <form class="d-flex" role="search">
          <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search"
            style="width: 500px; margin-left: 200px;" />
          <button class="btn btn-outline-light" type="submit">
            Search
          </button>
        </form>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent"
          aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse ms-5" id="navbarSupportedContent">
          <ul class="navbar-nav me-auto mb-2 mb-lg-0" id="nav-btn">
            <li class="nav-item">
              <a class="nav-link" aria-current="page" href="index.html">Ana sayfa</a>
            </li>
            <li class="nav-item">
              <a class="nav-link active" aria-current="page" href="urunler.html">Ürünler</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="iletisim.html">İletişim</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="sepet.html">Sepetim</a>
            </li>
          </ul>

          <button type="button" class="btn btn-outline-light position-relative"
            style="margin-right: 10px; border-radius: 50%; border: none;" onclick="location='favori.html'">
            <i class="fas fa-heart"></i>
          </button>

          <button type="button" class="btn btn-outline-light position-relative"
            style="margin-right: 50px; border-radius: 50%; border: none;" data-bs-toggle="offcanvas"
            data-bs-target="#offcanvasWithBothOptions" aria-controls="offcanvasWithBothOptions" onclick="sepetAc()">
            <i class="fa fa-shopping-cart"></i>
            <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger"><span id="cart-span-adet"></span><span
                class="visually-hidden">unread messages</span></span>
          </button>
        </div>
      </div>
    </nav>
    <div class="offcanvas offcanvas-start" data-bs-scroll="true" tabindex="-1" id="offcanvasWithBothOptions"
      aria-labelledby="offcanvasWithBothOptionsLabel">
      <div class="offcanvas-header">
        <h5 class="offcanvas-title" id="offcanvasWithBothOptionsLabel"><b>Sepetim</b></h5>
        <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
      </div>
      <hr>
      <div class="offcanvas-body">
        <div id="canvas-body">

        </div>

        <div class="basket-buttons">
          <button class="btn btn-secondary" onclick="clearLocal()">Sepeti Temizle</button>
          <button class="btn btn-success" onclick="location='sepet.html'">Alışverişi Tamamla</button>
        </div>
      </div>
    </div>
    <div class="row row-cols-1 row-cols-md-2">
      <div class="left-barside col">
        <div id="carouselExampleIndicators" class="carousel carousel-dark slide" data-bs-ride="true">
          <div class="carousel-indicators" style="position: relative; top: 550px; left: 120px">
            <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="0" class="active"
              aria-current="true" aria-label="Slide 1"></button>
            <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="1"
              aria-label="Slide 2"></button>
          </div>
          <div class="carousel-inner card" style="width: 700px; height: 500px">
            <div class="carousel-item active">
              <img src="img/şapka.jpg" class="img-thumbnail" alt="..." />
            </div>
            <div class="carousel-item active">
              <img src="img/elbise-resmi.jpg" class="img-thumbnail" alt="..." />
            </div>
          </div>
          <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleIndicators"
            data-bs-slide="prev" style="margin-left: 210px; margin-top: 150px">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Previous</span>
          </button>
          <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleIndicators"
            data-bs-slide="next" style="margin-right: -50px; margin-top: 150px">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Next</span>
          </button>
        </div>
        <div class="mini-photos">
          <a href=""><img src="img/elbise-resmi.jpg" class="img-thumbnail" alt="..." id="mini-photo1" /></a>
          <a href=""><img src="img/şapka.jpg" class="img-thumbnail" alt="..." id="mini-photo2" /></a>
        </div>
      </div>
      <div class="right-barside col">
        <nav
          style="--bs-breadcrumb-divider: url(&#34;data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E&#34;);"
          aria-label="breadcrumb">
          <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="index.html">Ana sayfa</a></li>
            <li class="breadcrumb-item"><a href="urunler.html">Ürünler</a></li>
            <li class="breadcrumb-item active" aria-current="page">Etek</li>
          </ol>
        </nav>
        <div class="card" id="product-info">
          <div class="product-name">
            <h5 id="product-title">İşlemeli Beyaz Mini Elbise</h5>
            <p id="seri-no">v1234-123</p>
            <p id="stok">Stok Durumu: <span id="stock-value">Var</span></p>
          </div>
          <div class="type">
            <div class="btn-group" role="group" aria-label="Basic radio toggle button group" id="size-group">
            </div>
          </div>
          <p id="price"><b>1.199,00 TL</b></p>
          <div class="rating">
            <input type="radio" name="rating" value="5" id="5" onclick="rate(this)"/><label for="5">☆</label>
            <input type="radio" name="rating" value="4" id="4" onclick="rate(this)"/><label for="4">☆</label>
            <input type="radio" name="rating" value="3" id="3" onclick="rate(this)"/><label for="3">☆</label>
            <input type="radio" name="rating" value="2" id="2" onclick="rate(this)"/><label for="2">☆</label>
            <input type="radio" name="rating" value="1" id="1" onclick="rate(this)"/><label for="1">☆</label>
            <a href="" style="font-size: 10px">Yorum Ekle</a>
          </div>

          <div class="share-btn">
            <a href="facebook.com">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                <path
                  d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z" />
              </svg>
            </a>
            <a href="">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                <g>
                  <path fill="none" d="M0 0h24v24H0z" />
                  <path fill-rule="nonzero"
                    d="M2.004 22l1.352-4.968A9.954 9.954 0 0 1 2 12C2 6.477 6.477 2 12 2s10 4.477 10 10-4.477 10-10 10a9.954 9.954 0 0 1-5.03-1.355L2.004 22zM8.391 7.308a.961.961 0 0 0-.371.1 1.293 1.293 0 0 0-.294.228c-.12.113-.188.211-.261.306A2.729 2.729 0 0 0 6.9 9.62c.002.49.13.967.33 1.413.409.902 1.082 1.857 1.971 2.742.214.213.423.427.648.626a9.448 9.448 0 0 0 3.84 2.046l.569.087c.185.01.37-.004.556-.013a1.99 1.99 0 0 0 .833-.231c.166-.088.244-.132.383-.22 0 0 .043-.028.125-.09.135-.1.218-.171.33-.288.083-.086.155-.187.21-.302.078-.163.156-.474.188-.733.024-.198.017-.306.014-.373-.004-.107-.093-.218-.19-.265l-.582-.261s-.87-.379-1.401-.621a.498.498 0 0 0-.177-.041.482.482 0 0 0-.378.127v-.002c-.005 0-.072.057-.795.933a.35.35 0 0 1-.368.13 1.416 1.416 0 0 1-.191-.066c-.124-.052-.167-.072-.252-.109l-.005-.002a6.01 6.01 0 0 1-1.57-1c-.126-.11-.243-.23-.363-.346a6.296 6.296 0 0 1-1.02-1.268l-.059-.095a.923.923 0 0 1-.102-.205c-.038-.147.061-.265.061-.265s.243-.266.356-.41a4.38 4.38 0 0 0 .263-.373c.118-.19.155-.385.093-.536-.28-.684-.57-1.365-.868-2.041-.059-.134-.234-.23-.393-.249-.054-.006-.108-.012-.162-.016a3.385 3.385 0 0 0-.403.004z" />
                </g>
              </svg>
            </a>
            <a href="">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                <path
                  d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z" />
              </svg>
            </a>
          </div>
          <button style="background: transparent; border: 0;" id="fav-btn" onclick="favOnClick()">
            <a>
              <i class="far fa-heart" id="fav-icon-a"></i>
              <!-- <i class="fas fa-heart"></i>  favorilere eklenince buton bu olucak-->
            </a>
          </button>
        </div>
        <div class="adet">
          <button id="plus-btn" style="border: none; background: transparent;" onclick="plus()"><b>+</b></button>
          <input type="number" disabled style="width: 100px; height: 40px; text-align: center" value="1" min="1"
            id="counter" onclick="productCounter()" />
          <button id="reduce-btn" style="border: none; background: transparent;" onclick="reduce()"><b>-</b></button>
          <button class="btn btn-outline-dark" id="sepet-btn" onclick="addSepet()">
            Sepete Ekle
          </button>
        </div>
        <div class="accordion accordion-flush" id="accordionFlushExample">
          <div class="accordion-item">
            <h2 class="accordion-header" id="flush-headingOne">
              <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                data-bs-target="#flush-collapseOne" aria-expanded="false" aria-controls="flush-collapseOne">
                Ürün Açıklama
              </button>
            </h2>
            <div id="flush-collapseOne" class="accordion-collapse collapse" aria-labelledby="flush-headingOne"
              data-bs-parent="#accordionFlushExample">
              <div class="accordion-body" id="product-description">
                1Ana Kumas:%100 PamukKuru Temizleme YapilirOrta Isida Ütüleme
                150CSikma YapilmazTamburlu Kurutma YapilmazAgartici
                KullanilmazYikama Yapilmaz
              </div>
            </div>
          </div>

          <div class="accordion-item">
            <h2 class="accordion-header" id="flush-headingThree">
              <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                data-bs-target="#flush-collapseThree" aria-expanded="false" aria-controls="flush-collapseThree">
                İade Koşulları
              </button>
            </h2>
            <div id="flush-collapseThree" class="accordion-collapse collapse" aria-labelledby="flush-headingThree"
              data-bs-parent="#accordionFlushExample">
              <div class="accordion-body">
                <b> İade Sürecim Hakkında Bilgi Almak İstiyorum </b> <br />
                İnternet Mağazamızdan yapılan satışlarda (mesafeli sözleşmeler
                ile satışlarda) tüketicilerin teslim aldığı tarihten itibaren 14
                gün içerisinde hiçbir hukuki ve cezai sorumluluk üstlenmeksizin
                ve hiç bir gerekçe göstermeksizin tüm ürünlerde malı reddederek
                ürünü iade hakkı mevcuttur.
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="comment row">
      <h6>Yorumlar</h6>
      <hr />
      <div class="first-comment">
        <div class="list-group" id="commentList" style="    max-height: 357px;
        overflow: auto;"></div>
        <button type="button" class="btn btn-warning" data-bs-toggle="modal" data-bs-target="#exampleModal"
          data-bs-whatever="@getbootstrap" style="margin-top: 30px;">Yorum Ekle</button>
        <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
          <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Yorum Ekle</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
              </div>
              <div class="modal-body">
                <form>
                  <div class="mb-3">
                    <label for="recipient-name" class="col-form-label">Yorum Başlık:</label>
                    <input type="email" class="form-control" id="commentTitle">
                  </div>
                  <div class="mb-3">
                    <label for="message-text" class="col-form-label">Yorum:</label>
                    <textarea class="form-control" id="commentDescription"></textarea>
                  </div>
                  <div class="mb-3" style="display: flex;">
                    <label for="recipient-name" class="col-form-label" style="padding-right: 10px;">Puanlama:</label>
                    <small class="text-muted">
                      <div class="rating">
                        <input type="radio" name="rating" value="5" id="a5" onclick="rate(this)"/><label for="a5">☆</label>
                        <input type="radio" name="rating" value="4" id="a4" onclick="rate(this)"/><label for="a4">☆</label>
                        <input type="radio" name="rating" value="3" id="a3" onclick="rate(this)"/><label for="a3">☆</label>
                        <input type="radio" name="rating" value="2" id="a2" onclick="rate(this)"/><label for="a2">☆</label>
                        <input type="radio" name="rating" value="1" id="a1" onclick="rate(this)"/><label for="a1">☆</label>
                      </div>
                    </small>
                  </div>
                </form>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn btn-warning" onclick="sendComment()">Gönder</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <footer class="footer row align-items-start">
      <div class="footer-1 col">
        <h3>Hakkımızda</h3>
        <hr>
        <p id="hakkımızda-footer">
          Lorem ipsum dolor sit amet consectetur adipisicing elit. Possimus,
          minus. Explicabo sapiente non unde ad nobis, asperiores cum sed
          facilis, vitae soluta delectus ab? Debitis quasi quidem magnam
          voluptatum tenetur.
        </p>
      </div>
      <div class="footer-2 col">
        <h2 style="height: 34px;">İletişim</h2>
        <hr>
        <p><i class="fa-solid fa-phone"></i> <span class="badge rounded-pill text-bg-light"><a href="">0212 432 23
              23</a></span></p>
        <p><i class="fa-solid fa-envelope"></i> <span class="badge rounded-pill text-bg-light"><a
              href="">canselim1@gmail.com</a></span></p>
        <p><i class="fa-solid fa-fax"></i> <span class="badge rounded-pill text-bg-light"><a
              href="">212-5551212</a></span></p>
      </div>
      <div class="footer-3 col">
        <h3>Ürünlerimiz</h3>
        <hr>
        <div class="urunler-footer">
          <span class="btn btn-sm btn-outline-light">Şapka</span>
          <span class="btn btn-sm btn-outline-light">Elbise</span>
          <span class="btn btn-sm btn-outline-light">Çanta</span>
          <span class="btn btn-sm btn-outline-light">T-shirt</span>
          <span class="btn btn-sm btn-outline-light">Terlik</span>
          <span class="btn btn-sm btn-outline-light">Çorap</span>
          <span class="btn btn-sm btn-outline-light">Ayakkabı</span>
          <span class="btn btn-sm btn-outline-light">Saat</span>
          <span class="btn btn-sm btn-outline-light">Kolye</span>
          <span class="btn btn-sm btn-outline-light">Bere</span>
          <span class="btn btn-sm btn-outline-light">Atkı</span>
          <span class="btn btn-sm btn-outline-light">Etek</span>
          <span class="btn btn-sm btn-outline-light">Babet</span>
        </div>
      </div>
    </footer>
    <script>
      var product = {
        code: null,
        description: null,
        id: null,
        photo: null,
        price: null,
        size: null,
        star: null,
        stock: null,
        title: null,
      };

      function saveBasket(data) {
        localStorage.setItem("sepet", JSON.stringify(data));
      }

      function saveFav(data) {
        localStorage.setItem("fav", JSON.stringify(data));
      }


      function getBasket() {
        var data = localStorage.getItem("sepet");
        console.log(data);
        if (data !== null && data !== "") {
          console.log("if içi");
          return JSON.parse(data);
        }
        else {
          console.log("else içi");
          saveBasket([]);
          return [];
        }
      }

      function getFav() {
        var data = localStorage.getItem("fav");
        console.log(data);
        if (data !== null && data !== "") {
          console.log("if içi");
          return JSON.parse(data);
        }
        else {
          console.log("else içi");
          saveFav([]);
          return [];
        }
      }

      var productDOM = {
        code: document.getElementById("seri-no"),
        description: document.getElementById("product-description"),
        price: document.getElementById("price"),
        size: document.getElementById("size-group"),
        star: null,
        stock: document.getElementById("stock-value"),
        title: document.getElementById("product-title"),
      };

      var sepetMenu = document.getElementById("canvas-body");
      var localSepet = getBasket();
      var localFav = getFav();
      var plusBtn = document.getElementById("plus-btn");
      var reduceBtn = document.getElementById("reduce-btn");
      var inputCounter = document.getElementById("counter");
      var basketCounter = document.getElementById("input-counter");
      const urunid = location.search.slice(1).split("=")[1];
      var fav_a = document.getElementById("fav-icon-a");
      var cart_adet = document.getElementById("cart-span-adet")
        cart_adet.outerText += localSepet.length;
      var comments, product;
      var selectSize;
      var rateStar;



      function basketPlus2(id) {
        var itemIndex = localSepet.findIndex(x => x.id === id);
        localSepet[itemIndex].adet++;
        document.getElementById("input-counter-" + id).value = localSepet[itemIndex].adet;
        saveBasket(localSepet);
      }

      function basketReduce2(id) {
        var itemIndex = localSepet.findIndex(x => x.id === id);
        if (localSepet[itemIndex].adet >= !0) {
          localSepet[itemIndex].adet--;
          document.getElementById("input-counter-" + id).value = localSepet[itemIndex].adet;
          saveBasket(localSepet);
        } if (document.getElementById("input-counter-" + id).value < 1) {
          localSepet.splice(itemIndex, 1);
          saveBasket(localSepet);
          location.reload();
        }
      }

      function sendComment() {
        var data = {
          p_id: location.search.slice(1).split("=")[1],
          title: document.getElementById("commentTitle").value,
          description: document.getElementById("commentDescription").value,
          star: rateStar
        };

        $.ajax({
          url: "http://192.168.1.2:4537/comments",
          method: "POST",
          contentType: "application/json",
          data: JSON.stringify(data),
          success: function (res) {
            var oyla;
          for (let i = 0; i < 5; i++) {
            oyla += [i];
            oyla[i] += `<span class="fa fa-star ${i <= rateStar ? 'checked' : ''}"></span>` 
            
            
          }
             console.log(oyla)

            if (res.status === "ok") {
              var commentsListDOM = document.getElementById("commentList");
              var coment = document.createRange().createContextualFragment(`<a href="#"  class="list-group-item list-group-item-action disabled">
            <div class="d-flex w-100 justify-content-between">
              <h5 class="mb-1">${data.title}</h5>
              <small class="text-muted">21.05.2022</small>
            </div>
            <p class="mb-1">${data.description}</p>
            <small class="text-muted">
            </small>
            <small class="text-muted">
              <div class="rating">
               ${oyla}
              </div>
            </small>
          </a>`
          );
          commentsListDOM.appendChild(coment);
         
            }
          },
          error: (err) => {
            console.log(err);
          }
        });


        console.log(data);
      }

      window.onload = function () {

        $.ajax({
          url: "http://192.168.1.2:4537/comments/" + urunid,
          method: "GET",
          success: successCallback,
          error: errorCallback
        })

        function successCallback(res) {
          if (res.status === "ok") {
            console.log(comments);
            comments = res.data;

            var commentsListDOM = document.getElementById("commentList");
            comments.forEach(el => {
              
              var coment = document.createRange().createContextualFragment(`<a href="#" onclick="deleteComment(${el.id})" class="list-group-item list-group-item-action disabled" style="display:block">
            <div class="d-flex w-100 justify-content-between">
              <h5 class="mb-1">${el.title}</h5>
              <small class="text-muted">21.05.2022</small>
            </div>
            <p class="mb-1">${el.description}</p>
            <small class="text-muted">
              <div class="rating">
                <span class="fa fa-star ${el.star > 4 ? 'checked' : ''}"></span>
                <span class="fa fa-star ${el.star > 3 ? 'checked' : ''}"></span>
                <span class="fa fa-star ${el.star > 2 ? 'checked' : ''}"></span>
                <span class="fa fa-star ${el.star > 1 ? 'checked' : ''}"></span>
                <span class="fa fa-star ${el.star > 0 ? 'checked' : ''}"></span>
              </div>
            </small>
          </a>`);
              commentsListDOM.appendChild(coment);
            });

          }
        }

        function test(desc) {
          console.log(desc);
        }

        function errorCallback(err) {
          console.log("ERROR => ", err);
        }


        $.ajax({
          url: `http://192.168.1.2:4537/products/${urunid}`,
          method: "GET",
          success: (res) => {
            if (res.status === "ok") {
              product = res.data;
              productDOM.title.innerHTML = product.title;
              productDOM.code.innerHTML = product.code;
              productDOM.description.innerHTML = product.description;
              productDOM.price.innerHTML = product.price;
              product.size = JSON.parse(product.size);
              console.log(product);

              if (product.stock > 0) {
                productDOM.stock.innerHTML = "Var"
              } else {
                productDOM.stock.innerHTML = "Yok";
                productDOM.stock.style = "color: red;"
              }
              productDOM.price.innerText = product.price;
              productDOM.price.style = "font-weight: bold;";
              product.size.forEach(el => {
                var box = `<input type="radio" class="btn-check" name="options-outlined" id="${el}" autocomplete="off" onClick="sizeSelected(${el})" /><label class="btn btn-outline-dark" for="${el}">${el}</label>`;
                productDOM.size.innerHTML += box;
              });
            }
            else {
              alert(res.error);
            }


          },
          error: errorCallback
        });
      };


      function sizeSelected(el) {
        selectSize = el
      }

      function sepeteAt() {
        localSepet.push({
          id: Number(localSepet.length),
          urunid: Number(urunid),
          title: product.title,
          price: Number(product.price),
          size: selectSize,
          adet: Number(inputCounter.value)
        });
        var sepetUrun = `<div class="basket-items row">
          <div class="col-4">
             <button class="close-button">
               <p>X</p>
             </button>
             <a href="urun-detay.html">
               <img src="img/şapka.jpg" class="img-thumbnail" alt="..." id="mini-photo2" />
             </a>
           </div>
           <div class="col-6">
             <a href="urun-detay.html">
               <h5>${product.title}</h5>
             </a>
             <hr>
             <div class="basket-info">
               <span>1X</span>
               <p id="basket-itemprice">${product.price}</p>
               <p>Beden: ${selectSize}</p>
               <div style="position: relative;left: 70px;bottom: 30px;">
               <button  id="plus-btn" style="border: none; background: transparent;" onclick="basketPlus()"><b>+</b></button>
           <input type="number" disabled style="width: 70px; height: 30px; text-align: center" value="${inputCounter.value}" id="counter" onclick="productCounter()"/>
           <button  id="reduce-btn" style="border: none; background: transparent;" onclick="basketReduce()"><b>-</b></button>
         </div>
             </div>
           </div>
         </div>`;
        sepetMenu.innerHTML += sepetUrun;
        saveBasket(localSepet);
      }

      function addSepet() {
        let urunler = [];

        localSepet.forEach((el, i) => {
          if (el.urunid == product.id) {
            el.index = i;
            urunler.push(el);
          }
        });

        let urunIndex = localSepet.findIndex(item => {
          return item.urunid == urunid
        });

        let sizeInfo = localSepet.findIndex(item => {
          return item.size == selectSize;
        });

        if (selectSize != null) {
          if (urunler.length > 1) {
            let urunlerIndex = urunler.findIndex(el => {
              return el.size == selectSize;
            });

            if (urunlerIndex !== -1) {
              localSepet[urunler[urunlerIndex].index].adet += Number(inputCounter.value);
              saveBasket(localSepet);
            }
            else {
              sepeteAt();
            }
          }
          else {
            if (urunler.length < 1) {
              sepeteAt();
            }
            else {
              if (urunler[0].size == selectSize) {
                localSepet[urunler[0].index].adet += Number(inputCounter.value);
                saveBasket(localSepet);
              }
              else {
                sepeteAt();
              }
            }
          }
        } else {
          alert("hata")
        }
        location.reload();
      }


      function plus() {
        ++inputCounter.value
      }

      function sepetAc() {
        sepetMenu.innerHTML = "";
        localSepet.forEach(el => {
          var sepetUrun = `<div class="basket-items row" id="item-${el.id}">
          <div class="col-4">
            <button class="close-button" onclick="clearProduct(${el.id})">
              <p>X</p>
            </button>
            <a href="urun-detay.html">
              <img src="img/şapka.jpg" class="img-thumbnail" alt="..." id="mini-photo2" />
            </a>
          </div>
          <div class="col-6">
            <a href="urun-detay.html">
              <h5>${el.title}</h5>
            </a>
            <hr>
            <div class="basket-info">
              <span>1X</span>
              <p id="basket-itemprice">${el.price}</p>
              <p>Beden: ${el.size}</p>
              <div style="position: relative;left: 70px;bottom: 30px;">
              <button  id="plus-btn" style="border: none; background: transparent;" onclick="basketPlus2(${el.id})"><b>+</b></button>
          <input type="text" disabled style="width: 70px; height: 30px; text-align: center" value="${el.adet}" id="input-counter-${el.id}"/>
          <button  id="reduce-btn" style="border: none; background: transparent;" onclick="basketReduce2(${el.id})"><b>-</b></button>
        </div>
            </div>
          </div>
        </div>`;
          sepetMenu.innerHTML += sepetUrun;
        })
      }

      function reduce() {
        if (inputCounter.value >= 2) {
          --inputCounter.value
        }
      }

      function clearLocal() {
        localStorage.clear()
        location.reload()
      }
      function clearProduct(id) {
        var itemIndex = localSepet.findIndex(x => x.id == id);
        localSepet.splice(itemIndex, 1);
        saveBasket(localSepet);
        location.reload();
      }

      function favOnClick() {
        var fav_id = localFav.findIndex(e => e.urunid == urunid);
        if (fav_a.className != "fas fa-heart") {
          fav_a.className = "fas fa-heart";
          localFav.push({
            title: product.title,
            description: product.description,
            urunid: product.id,
          });
          saveFav(localFav);
        } else {
          fav_a.className = "far fa-heart";
          localFav.splice(fav_id,1);
          saveFav(localFav);
        }
      }
      var fav_id = localFav.findIndex(e => e.urunid == urunid);
      console.log(fav_id)
        if(fav_id != -1){
        fav_a.className = "fas fa-heart";
        }

        function rate(el) {
          rateStar = el.value;
          console.log(rateStar)
        }
    </script>
</body>

</html>